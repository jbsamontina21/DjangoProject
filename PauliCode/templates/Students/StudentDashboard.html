{% load static %}
{% include "partials/header.html" %}

<style>
  body {
    background-color: #111827 !important;
  }

  .color-green{
    background-color: rgb(35, 103, 51) !important;
  }

  .card {
    background-color: #1f2937;
  }

  .action-card:hover {
    transform: scale(1.05);
    transition: 0.2s ease;
  }

  h5, h6, p {
    color: white;
  }

  .btn-close-white {
    filter: invert(1);
  }
</style>

<body class="g-sidenav-show text-white">
  <div class="min-height-300 position-absolute w-100"></div>

  {% include "partials/StudentSidebar.html" %} <!-- Sidebar -->

  <main class="main-content position-relative border-radius-lg">
    <div class="container-fluid p-5">

      <!-- Welcome Section -->
      <div class="card bg-success text-white border-0 mb-4 rounded-4 shadow-sm">
        <div class="card-body py-4">
          <h3 class="fw-bold text-white">Welcome back, {{ user.first_name }}!</h3>
          <h6 class="text-white small">Explore your classes and start learning today.</h6>
        </div>
      </div>

      <!-- Quick Actions -->
      <h5 class="fw-bold mb-3">Quick Actions</h5>
      <div class="row g-3 mb-5">

        <div class="col-md-3">
          <div class="card text-center bg-success text-white border-0 rounded-4 shadow-sm action-card h-100" data-bs-toggle="modal" data-bs-target="#joinClassModal">
            <div class="card-body">
              <h1 class="display-5 mb-2" style="color: white;">+</h1>
              <h6 class="fw-bold">Join Class</h6>
              <p class="text-light small mb-0">Enter class code</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray text-white border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <h1 class="display-6 mb-2" style="color: skyblue">&lt;/&gt;</h1>
              <h6 class="fw-bold">Practice Coding</h6>
              <p class="text-light small mb-0">Code Playground</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <img src="{% static 'img/progressIcon.png' %}" alt="progress" width="40" height="40" class="mb-2">
              <h6 class="fw-bold">View Progress</h6>
              <p class="text-light small mb-0">Track your progress</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <img src="{% static 'img/PendingIC.png' %}" alt="pendingIcon" width="40" height="40" class="mb-2">
              <h6 class="fw-bold">Pending Task</h6>
              <p class="text-light small mb-0">View tasks</p>
            </div>
          </div>
        </div>

      </div>

      <!-- Joined Classes -->
      <h5 class="fw-bold mb-3">Joined Classes</h5>
      <div class="row g-3">
        {% if classes %}
          {% for class in classes %}
            <div class="col-md-3">
              <div class="card text-center border-0 rounded-4 shadow-sm h-100 text-white {% cycle 'color-green' 'bg-dark' %} action-card">
                <div class="card-body">
                  <img src="{{ class.upload_icon.url|default:'/media/class_icons/defaultClassIcon.png' }}" 
                       alt="Class Icon" width="100" height="100" class="mb-2 rounded">
                  <h6 class="fw-bold">{{ class.title }}</h6>
                  <p class="small text-light mb-0">{{ class.class_code }}</p>
                </div>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <p class="text-muted">You have not joined any classes yet.</p>
        {% endif %}
      </div>

      {% include "partials/footer.html" %}
    </div>
  </main>

  {% include "partials/scripts.html" %}

  <div class="modal fade" id="joinClassModal" tabindex="-1" aria-labelledby="joinClassLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
      <div class="modal-content shadow-lg border-0" style="background-color: #1E2835; color: white; border-radius: 16px;">
        <div class="modal-header border-0">
          <h5 class="modal-title fw-bold text-success" id="joinClassLabel">
            Join a Class
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body pt-0">
          <p class="text-muted small mb-4">Enter the class code provided by your teacher to join a class.</p>

          <form id="joinClassForm" method="POST" action="{% url 'join_class' %}">
            {% csrf_token %}
            <div class="mb-3">
              <label class="form-label fw-bold">Class Code</label>
              <input type="text" name="class_code" class="form-control text-white"
                     placeholder="Enter class code"
                     style="background-color: #101826; border: 1px solid #4CD964; border-radius: 8px;">
            </div>

            <div class="d-flex justify-content-end">
              <button type="button" class="btn btn-outline-secondary btn-sm me-2 px-3" data-bs-dismiss="modal">
                <i class="fa fa-times me-1"></i> Cancel
              </button>
              <button type="submit" class="btn btn-success btn-sm px-3">
                <i class="fa fa-plus me-1"></i> Join Class
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
