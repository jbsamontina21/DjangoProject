{% load static %}
{% include "partials/header.html" %}

<style>
  .color-green{
        background-color: rgb(35, 103, 51) !important;
    }
  body {
    background-color: #111827 !important;
  }

  .card {
    background-color: #1f2937;
  }

  .action-card:hover {
    transform: scale(1.05);
    transition: 0.2s ease;
  }

  h5, h6, p {
    color: white;
  }
  .border-dashed {
  border-style: dashed !important;
}
.btn-close-white {
  filter: invert(1);
}

#previewContainer {
  background-color: #0f172a;
  overflow: hidden;
}
#previewImage {
  object-fit: cover;
  width: 100%;
  height: 100%;
}


</style>

<body class="g-sidenav-show  text-white" style = "background-color: #273149">
  <div class="min-height-300  position-absolute w-100"></div>

  {% include "partials/sidebar.html" %} <!-- Sidebar -->

  <main class="main-content position-relative border-radius-lg">
    <!-- Navbar -->
  
    <!-- End Navbar -->

    <div class="container-fluid p-5">

      <!-- Welcome Section -->
      <div class="card bg-success text-white border-0 mb-4 rounded-4 shadow-sm">
        <div class="card-body py-4">
          <h3 class="fw-bold text-white">Welcome back, {{user.first_name}}!</h3>
         <h6 class="text-white small">Empower your students today and help them build the skills for tomorrow.</h6>

        </div>
      </div>

      <!-- Quick Actions -->
      <h5 class="fw-bold mb-3">Quick Actions</h5>
      <div class="row g-3 mb-5">

        <div class="col-md-3">
          <div class="card text-center bg-success text-white border-0 rounded-4 shadow-sm action-card h-100" data-bs-toggle="modal" data-bs-target="#createClassModal">
            <div class="card-body">
              <h1 class="display-5 mb-2" style = "color: white;">+</h1>
              <h6 class="fw-bold">Create New Class</h6>
              <p class="text-light small mb-0">Enter class code</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray text-white border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <h1 class="display-6 mb-2" style = "color: skyblue">&lt;/&gt;</h1>
              <h6 class="fw-bold">Practice Coding</h6>
              <p class="text-light small mb-0">Code Playground</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <img src="{% static 'img/progressIcon.png' %}" alt="progress" width="40" height="40" class="mb-2">
              <h6 class="fw-bold">View Progress</h6>
              <p class="text-light small mb-0">Track your Students</p>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center button-gray border-0 rounded-4 shadow-sm h-100 action-card">
            <div class="card-body">
              <img src="{% static 'img/PendingIC.png' %}" alt="pendingIcon" width="40" height="40" class="mb-2">
              <h6 class="fw-bold">Pending Task</h6>
              <p class="text-light small mb-0">View task</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Classes -->
      <h5 class="fw-bold mb-3">Recent Classes</h5>
        <div class="row g-3">
          {% if classes %}
            {% for class in classes %}
              <div class="col-md-3">
                <div class="card text-center border-0 rounded-4 shadow-sm h-100 text-white {% cycle 'color-green' 'bg-dark' %} action-card">
                  <div class="card-body">
                    <img src="{{ class.upload_icon.url|default:'/media/class_icons/defaultClassIcon.png' }}" 
                        alt="Class Icon" width="100" height="100" class="mb-2 rounded">
                    <h6 class="fw-bold">{{ class.title }}</h6>
                    <p class="small text-light mb-0">{{ class.class_code }}</p>
                  </div>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="text-muted">No classes created yet.</p>
          {% endif %}
        </div>


      {% include "partials/footer.html" %}
    </div>
  </main>

 




    <!-- CREATE CLASS MODAL -->
    <div class="modal fade" id="createClassModal" tabindex="-1" aria-labelledby="createClassLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content shadow-lg border-0" style="background-color: #1E2835; color: #fff; border-radius: 16px;">
          <div class="modal-header border-0 pb-1">
            <h5 class="modal-title fw-bold text-success" id="createClassLabel">
              <i class="fa fa-layer-group"></i> Create New Class
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body pt-0">
            <p class="text-muted small mb-4">
              Fill in the details below to set up your new class environment.
            </p>

            <form id="createClassForm" method="POST" enctype="multipart/form-data" action="{% url 'create_class' %}">
              {% csrf_token %}

              <!-- Upload Section -->
              <div class="mb-4">
                <label class="form-label fw-bold">Class Thumbnail</label>
                <div class="upload-box border border-2 border-dashed rounded d-flex align-items-center justify-content-center position-relative overflow-hidden" 
                    style="width: 120px; height: 120px; background-color: #101826; cursor: pointer;">
                  <input type="file" id="uploadIcon" name="upload_icon" accept="image/*" class="position-absolute w-100 h-100 opacity-0" style="cursor: pointer;">
                  <div class="text-center" id="uploadPlaceholder">
                    <i class="fa fa-camera mb-2 text-muted" style="font-size: 28px;"></i>
                    <p class="small text-muted mb-0">Upload</p>
                  </div>
                  <img id="previewImage" src="#" alt="Preview" class="d-none position-absolute top-0 start-0 w-100 h-100 rounded" style="object-fit: cover;">
                </div>
                <p class="text-muted small mt-2 mb-0">Recommended size: <strong>400Ã—400px</strong> (JPG, PNG)</p>
              </div>

              <!-- Class Code -->
              <div class="mb-3">
                <label class="form-label fw-bold">Class Code</label>
                <div class="input-group">
                  <span class="input-group-text bg-success border-0 text-white fw-bold">#</span>
                  <input type="text" name="class_code" class="form-control text-white p-2"
                        placeholder="Enter unique class code (e.g., APPDEV3)"
                        style="background-color: #101826; border: 1px solid #4CD964; border-radius: 0 8px 8px 0;">
                </div>
              </div>

              <!-- Class Title -->
              <div class="mb-3">
                <label class="form-label fw-bold">Class Title</label>
                <input type="text" name="title" class="form-control text-white"
                      placeholder="Enter class title (e.g., Application Development)"
                      style="background-color: #101826; border: 1px solid #555; border-radius: 8px;">
              </div>

              <!-- Description -->
              <div class="mb-4">
                <label class="form-label fw-bold">Class Description</label>
                <textarea name="description" rows="3" class="form-control text-white"
                          placeholder="Enter class description..."
                          style="background-color: #101826; border: 1px solid #555; border-radius: 8px;"></textarea>
              </div>

              <!-- Buttons -->
              <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-outline-secondary btn-sm me-2 px-3" data-bs-dismiss="modal">
                  <i class="fa fa-times me-1"></i> Cancel
                </button>
                <button type="submit" class="btn btn-success btn-sm px-3">
                  <i class="fa fa-plus me-1"></i> Create Class
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
 {% include "partials/scripts.html" %}

  <script>
document.addEventListener("DOMContentLoaded", function () {
  const uploadInput = document.getElementById("uploadIcon");
  const previewImage = document.getElementById("previewImage");
  const uploadIcon = document.getElementById("uploadIconIcon");
  const uploadText = document.getElementById("uploadIconText");

  if (!uploadInput) return; // safety check

  uploadInput.addEventListener("change", function (event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        previewImage.src = e.target.result;
        previewImage.classList.remove("d-none");
        uploadIcon.style.display = "none";
        uploadText.style.display = "none";
      };
      reader.readAsDataURL(file);
    } else {
      previewImage.src = "#";
      previewImage.classList.add("d-none");
      uploadIcon.style.display = "block";
      uploadText.style.display = "block";
    }
  });
});
</script>

<!-- Thumbnail Preview Script -->
<script>
document.getElementById("uploadIcon").addEventListener("change", function (event) {
  const file = event.target.files[0];
  const preview = document.getElementById("previewImage");
  const placeholder = document.getElementById("uploadPlaceholder");

  if (file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      preview.src = e.target.result;
      preview.classList.remove("d-none");
      placeholder.style.display = "none";
    };
    reader.readAsDataURL(file);
  } else {
    preview.src = "#";
    preview.classList.add("d-none");
    placeholder.style.display = "block";
  }
});
</script>
</body>


</html>


